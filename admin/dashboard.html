<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>DineFlow - Restaurant Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#ff8000",
                        "background-light": "#f8f7f5",
                        "background-dark": "#23190f",
                        "success": "#38A169",
                        "danger": "#E53E3E",
                        "text-light": "#1A202C",
                        "text-dark": "#F7F8FA",
                        "border-light": "#E2E8F0",
                        "border-dark": "#3a2d21",
                        "card-light": "#FFFFFF",
                        "card-dark": "#2a1e12"
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
        .material-symbols-outlined.fill {
            font-variation-settings: 'FILL' 1;
        }
        .notification-toast {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark">
    <div class="flex h-screen w-full">
        <!-- Standardized Sidebar -->
        <aside class="flex w-64 flex-col border-r border-[#f5f2f0] dark:border-[#2f271f] bg-white dark:bg-background-dark px-4 py-5">
            <div class="flex flex-col gap-4">
                <div class="flex items-center gap-3 px-3">
                    <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="DineFlow company logo" style='background-image: url("https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=100&q=80");'></div>
                    <div class="flex flex-col">
                        <h1 class="text-[#181410] dark:text-white text-base font-medium leading-normal">DineFlow</h1>
                        <p class="text-[#8d755e] dark:text-[#a1907c] text-sm font-normal leading-normal" id="restaurantName">Restaurant Admin</p>
                    </div>
                </div>
            </div>
            <nav class="flex flex-col gap-2 mt-4">
                <!-- Dashboard Button - Active -->
                <a class="flex items-center gap-3 px-3 py-2 text-gray-900 dark:text-white rounded-lg bg-primary/10 dark:bg-primary/20 ring-1 ring-primary/20" href="dashboard.html">
                    <span class="material-symbols-outlined text-primary" style="font-variation-settings: 'FILL' 1;">dashboard</span>
                    <p class="text-sm font-medium leading-normal text-primary">Dashboard</p>
                </a>
                <a class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" href="order-management.html">
                    <span class="material-symbols-outlined">receipt_long</span>
                    <p class="text-sm font-medium leading-normal">Orders</p>
                </a>
                <a class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" href="menu-management.html">
                    <span class="material-symbols-outlined">menu_book</span>
                    <p class="text-sm font-medium leading-normal">Menu</p>
                </a>
                <a class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" href="table-management.html">
                    <span class="material-symbols-outlined">table_restaurant</span>
                    <p class="text-sm font-medium leading-normal">Tables</p>
                </a>
                <!-- New Analytics Button -->
                <a class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" href="analytics.html">
                    <span class="material-symbols-outlined">analytics</span>
                    <p class="text-sm font-medium leading-normal">Analytics</p>
                </a>
                <!-- New Add-ons Button -->
                <a class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" href="addon-management.html">
                    <span class="material-symbols-outlined">extension</span>
                    <p class="text-sm font-medium leading-normal">Add-ons</p>
                </a>
            </nav>
            <div class="flex flex-col gap-1">
                <a class="flex items-center gap-3 px-3 py-2 text-[#8d755e] dark:text-[#a1907c] hover:bg-[#f5f2f0] dark:hover:bg-[#2f271f] rounded-lg" href="#">
                    <span class="material-symbols-outlined text-2xl">settings</span>
                    <p class="text-sm font-medium leading-normal">Settings</p>
                </a>
                <a class="flex items-center gap-3 px-3 py-2 text-[#8d755e] dark:text-[#a1907c] hover:bg-[#f5f2f0] dark:hover:bg-[#2f271f] rounded-lg" href="#">
                    <span class="material-symbols-outlined text-2xl">help</span>
                    <p class="text-sm font-medium leading-normal">Help</p>
                </a>
                <button id="logoutBtn" class="flex items-center gap-3 px-3 py-2 text-[#8d755e] dark:text-[#a1907c] hover:bg-[#f5f2f0] dark:hover:bg-[#2f271f] rounded-lg w-full text-left">
                    <span class="material-symbols-outlined text-2xl">logout</span>
                    <p class="text-sm font-medium leading-normal">Logout</p>
                </button>
            </div>
        </aside>

        <main class="flex flex-1 flex-col">
            <!-- TopNavBar -->
            <header class="flex items-center justify-between whitespace-nowrap border-b border-[#f5f2f0] dark:border-[#2f271f] bg-white dark:bg-background-dark px-10 py-3 sticky top-0 z-10">
                <div class="flex items-center gap-8">
                    <h2 class="text-[#181410] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">Dashboard</h2>
                </div>
                <div class="flex flex-1 justify-end items-center gap-4">
                    <label class="flex flex-col min-w-40 h-10 w-full max-w-sm">
                        <div class="flex w-full flex-1 items-stretch rounded-lg h-full">
                            <div class="text-[#8d755e] flex bg-[#f5f2f0] dark:bg-[#2f271f] items-center justify-center pl-4 rounded-l-lg">
                                <span class="material-symbols-outlined">search</span>
                            </div>
                            <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#181410] dark:text-white focus:outline-0 focus:ring-0 border-none bg-[#f5f2f0] dark:bg-[#2f271f] h-full placeholder:text-[#8d755e] px-4 rounded-l-none border-l-0 pl-2 text-base font-normal leading-normal" placeholder="Search orders, customers..." value=""/>
                        </div>
                    </label>
                    <div class="flex gap-2">
                        <button class="flex cursor-pointer items-center justify-center rounded-lg h-10 w-10 bg-white dark:bg-background-dark text-[#8d755e] hover:bg-[#f5f2f0] dark:hover:bg-[#2f271f]">
                            <span class="material-symbols-outlined">notifications</span>
                        </button>
                        <button class="flex cursor-pointer items-center justify-center rounded-lg h-10 w-10 bg-white dark:bg-background-dark text-[#8d755e] hover:bg-[#f5f2f0] dark:hover:bg-[#2f271f]">
                            <span class="material-symbols-outlined">help_outline</span>
                        </button>
                    </div>
                    <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="User profile avatar" style='background-image: url("https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=100&q=80");'></div>
                </div>
            </header>

            <!-- Main Content -->
            <div class="flex-1 p-8 space-y-8 overflow-y-auto">
                <!-- Stats -->
                <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="flex flex-col gap-2 rounded-xl p-6 bg-white dark:bg-[#2a2116] shadow-sm border border-[#f5f2f0] dark:border-[#2f271f]">
                        <p class="text-[#8d755e] dark:text-[#a1907c] text-base font-medium leading-normal">Total Revenue</p>
                        <p class="text-[#181410] dark:text-white tracking-tight text-3xl font-bold leading-tight" id="totalRevenue">$0</p>
                        <p class="text-success text-sm font-medium leading-normal">+0% vs last month</p>
                    </div>
                    <div class="flex flex-col gap-2 rounded-xl p-6 bg-white dark:bg-[#2a2116] shadow-sm border border-[#f5f2f0] dark:border-[#2f271f]">
                        <p class="text-[#8d755e] dark:text-[#a1907c] text-base font-medium leading-normal">Total Orders</p>
                        <p class="text-[#181410] dark:text-white tracking-tight text-3xl font-bold leading-tight" id="totalOrders">0</p>
                        <p class="text-success text-sm font-medium leading-normal">+0% vs last month</p>
                    </div>
                    <div class="flex flex-col gap-2 rounded-xl p-6 bg-white dark:bg-[#2a2116] shadow-sm border border-[#f5f2f0] dark:border-[#2f271f]">
                        <p class="text-[#8d755e] dark:text-[#a1907c] text-base font-medium leading-normal">Active Tables</p>
                        <p class="text-[#181410] dark:text-white tracking-tight text-3xl font-bold leading-tight" id="activeTables">0</p>
                        <p class="text-danger text-sm font-medium leading-normal">-0% vs last month</p>
                    </div>
                    <div class="flex flex-col gap-2 rounded-xl p-6 bg-white dark:bg-[#2a2116] shadow-sm border border-[#f5f2f0] dark:border-[#2f271f]">
                        <p class="text-[#8d755e] dark:text-[#a1907c] text-base font-medium leading-normal">Pending Orders</p>
                        <p class="text-[#181410] dark:text-white tracking-tight text-3xl font-bold leading-tight" id="pendingOrders">0</p>
                        <p class="text-success text-sm font-medium leading-normal">+0% vs last month</p>
                    </div>
                </section>

                <!-- Charts -->
                <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 flex flex-col gap-4 rounded-xl border border-[#f5f2f0] dark:border-[#2f271f] bg-white dark:bg-[#2a2116] p-6 shadow-sm">
                        <div class="flex justify-between items-center">
                            <h3 class="text-[#181410] dark:text-white text-lg font-semibold leading-normal">Recent Orders</h3>
                        </div>
                        <div class="flex-1">
                            <div id="recentOrders" class="space-y-4">
                                <!-- Recent orders will be loaded here -->
                                <div class="text-center text-[#8d755e] dark:text-[#a1907c] py-8">
                                    <span class="material-symbols-outlined text-4xl mb-2">receipt_long</span>
                                    <p>No recent orders</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-col gap-4 rounded-xl border border-[#f5f2f0] dark:border-[#2f271f] bg-white dark:bg-[#2a2116] p-6 shadow-sm">
                        <h3 class="text-[#181410] dark:text-white text-lg font-semibold leading-normal">Quick Actions</h3>
                        <div class="space-y-3">
                            <a href="menu-management.html" class="flex items-center gap-3 p-3 rounded-lg bg-[#f5f2f0] dark:bg-[#2f271f] hover:bg-primary/10 transition-colors">
                                <span class="material-symbols-outlined text-primary">restaurant_menu</span>
                                <span class="text-sm font-medium">Manage Menu</span>
                            </a>
                            <a href="table-management.html" class="flex items-center gap-3 p-3 rounded-lg bg-[#f5f2f0] dark:bg-[#2f271f] hover:bg-primary/10 transition-colors">
                                <span class="material-symbols-outlined text-primary">table_restaurant</span>
                                <span class="text-sm font-medium">Manage Tables</span>
                            </a>
                            <a href="order-management.html" class="flex items-center gap-3 p-3 rounded-lg bg-[#f5f2f0] dark:bg-[#2f271f] hover:bg-primary/10 transition-colors">
                                <span class="material-symbols-outlined text-primary">receipt_long</span>
                                <span class="text-sm font-medium">View Orders</span>
                            </a>
                        </div>
                    </div>
                </section>

                <!-- Trending Menus -->
                <section>
                    <h2 class="text-[#181410] dark:text-white text-2xl font-bold leading-tight tracking-[-0.015em] mb-4">Popular Items</h2>
                    <div id="popularItems" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                        <!-- Popular items will be loaded here -->
                        <div class="text-center text-[#8d755e] dark:text-[#a1907c] py-8 col-span-full">
                            <span class="material-symbols-outlined text-4xl mb-2">restaurant</span>
                            <p>No popular items yet</p>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script type="module">
        import { AuthService } from '../js/auth.js';
        import { supabase } from '../js/supabase.js';

        class Dashboard {
            constructor() {
                this.user = null;
                this.restaurant = null;
                this.init();
            }

            async init() {
                console.log('Initializing dashboard...');
                
                // Check authentication
                this.user = await AuthService.getCurrentUser();
                if (!this.user) {
                    console.log('No user, redirecting to login...');
                    window.location.href = 'login.html';
                    return;
                }

                console.log('User authenticated:', this.user);

                // Load restaurant data
                await this.loadRestaurantData();
                
                // Load dashboard data
                await this.loadDashboardData();

                // Set up logout
                document.getElementById('logoutBtn').addEventListener('click', this.logout.bind(this));

                // Refresh data every 30 seconds
                setInterval(() => {
                    this.loadDashboardData();
                }, 30000);
            }

            async loadRestaurantData() {
                try {
                    console.log('Loading restaurant data...');
                    this.restaurant = await AuthService.getRestaurant();
                    
                    if (this.restaurant) {
                        console.log('Restaurant loaded:', this.restaurant);
                        document.getElementById('restaurantName').textContent = this.restaurant.name;
                    } else {
                        console.error('No restaurant found for user:', this.user.id);
                        this.showNotification('No restaurant found. Please contact support.', 'error');
                    }
                } catch (error) {
                    console.error('Error loading restaurant data:', error);
                    this.showNotification('Error loading restaurant data: ' + error.message, 'error');
                }
            }

            async loadDashboardData() {
                try {
                    if (!this.restaurant) {
                        console.error('Cannot load dashboard data: No restaurant data');
                        return;
                    }

                    console.log('Loading dashboard data for restaurant:', this.restaurant.id);
                    
                    // Load all data in parallel
                    const [orders, tables, menuItems] = await Promise.all([
                        this.loadOrders(),
                        this.loadTables(),
                        this.loadMenuItems()
                    ]);

                    this.updateOrderStats(orders);
                    this.updateTableStats(tables, orders);
                    this.displayRecentOrders(orders);
                    this.displayPopularItems(menuItems, orders);

                } catch (error) {
                    console.error('Error loading dashboard data:', error);
                    this.showNotification('Error loading dashboard data: ' + error.message, 'error');
                }
            }

            async loadOrders() {
                try {
                    const { data: orders, error } = await supabase
                        .from('orders')
                        .select(`
                            *,
                            order_items (
                                *,
                                menu_items ( name ),
                                order_item_addons ( addon_name, addon_price, quantity )
                            ),
                            tables ( table_number )
                        `)
                        .eq('restaurant_id', this.restaurant.id)
                        .order('order_time', { ascending: false });

                    if (error) throw error;
                    return orders || [];
                } catch (error) {
                    console.error('Error loading orders:', error);
                    return [];
                }
            }

            async loadTables() {
                try {
                    const { data: tables, error } = await supabase
                        .from('tables')
                        .select('*')
                        .eq('restaurant_id', this.restaurant.id)
                        .order('table_number');

                    if (error) throw error;
                    return tables || [];
                } catch (error) {
                    console.error('Error loading tables:', error);
                    return [];
                }
            }

            async loadMenuItems() {
                try {
                    const { data: menuItems, error } = await supabase
                        .from('menu_items')
                        .select('*')
                        .eq('restaurant_id', this.restaurant.id)
                        .order('name');

                    if (error) throw error;
                    return menuItems || [];
                } catch (error) {
                    console.error('Error loading menu items:', error);
                    return [];
                }
            }

            updateOrderStats(orders) {
                try {
                    // Filter today's orders using order_time
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    const todayOrders = orders.filter(order => {
                        const orderTime = new Date(order.order_time);
                        return orderTime >= today;
                    });

                    // Calculate totals
                    const totalRevenue = orders.reduce((sum, order) => sum + (order.total_amount || 0), 0);
                    const totalOrders = orders.length;
                    const pendingOrders = orders.filter(order => order.status === 'pending').length;
                    const todayRevenue = todayOrders.reduce((sum, order) => sum + (order.total_amount || 0), 0);
                    const todayOrdersCount = todayOrders.length;

                    // Update DOM
                    document.getElementById('totalRevenue').textContent = `$${totalRevenue.toFixed(2)}`;
                    document.getElementById('totalOrders').textContent = totalOrders.toString();
                    document.getElementById('pendingOrders').textContent = pendingOrders.toString();

                    // Update percentage changes
                    const revenueChange = document.querySelector('#totalRevenue + p');
                    const ordersChange = document.querySelector('#totalOrders + p');
                    const pendingChange = document.querySelector('#pendingOrders + p');

                    if (revenueChange) revenueChange.textContent = `+$${todayRevenue.toFixed(2)} today`;
                    if (ordersChange) ordersChange.textContent = `+${todayOrdersCount} today`;
                    if (pendingChange) pendingChange.textContent = `${pendingOrders} need attention`;

                } catch (error) {
                    console.error('Error updating order stats:', error);
                }
            }

            updateTableStats(tables, orders) {
                try {
                    // Find active tables (tables with pending/preparing orders)
                    const activeTableIds = new Set();
                    orders
                        .filter(order => order.status === 'pending' || order.status === 'preparing')
                        .forEach(order => {
                            if (order.table_id) activeTableIds.add(order.table_id);
                        });

                    const activeTables = activeTableIds.size;
                    const totalTables = tables.length;

                    document.getElementById('activeTables').textContent = activeTables.toString();

                    // Update percentage text
                    const tablesChange = document.querySelector('#activeTables + p');
                    if (tablesChange) {
                        tablesChange.textContent = `${activeTables}/${totalTables} tables in use`;
                    }

                } catch (error) {
                    console.error('Error updating table stats:', error);
                }
            }

            displayRecentOrders(orders) {
                const container = document.getElementById('recentOrders');
                
                if (!orders || orders.length === 0) {
                    container.innerHTML = `
                        <div class="text-center text-[#8d755e] dark:text-[#a1907c] py-8">
                            <span class="material-symbols-outlined text-4xl mb-2">receipt_long</span>
                            <p>No recent orders</p>
                        </div>
                    `;
                    return;
                }

                // Get last 5 orders
                const recentOrders = orders.slice(0, 5);
                
                // Helper function to format relative time
                const getRelativeTime = (orderTime) => {
                    const now = new Date();
                    const orderDate = new Date(orderTime);
                    const diffMs = now - orderDate;
                    const diffMins = Math.floor(diffMs / 60000);
                    const diffHours = Math.floor(diffMs / 3600000);
                    const diffDays = Math.floor(diffMs / 86400000);

                    if (diffMins < 1) return 'Just now';
                    if (diffMins < 60) return `${diffMins}m ago`;
                    if (diffHours < 24) return `${diffHours}h ago`;
                    if (diffDays === 1) return 'Yesterday';
                    if (diffDays < 7) return `${diffDays}d ago`;
                    
                    return orderDate.toLocaleDateString();
                };

                container.innerHTML = recentOrders.map(order => {
                    const relativeTime = getRelativeTime(order.order_time);
                    const exactTime = new Date(order.order_time).toLocaleTimeString([], { 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });

                    return `
                        <div class="flex items-center justify-between p-4 bg-[#f5f2f0] dark:bg-[#2f271f] rounded-lg">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-primary/20 rounded-lg flex items-center justify-center">
                                    <span class="material-symbols-outlined text-primary">receipt</span>
                                </div>
                                <div>
                                    <p class="font-medium text-[#181410] dark:text-white">Order #${order.order_number}</p>
                                    <p class="text-sm text-[#8d755e] dark:text-[#a1907c]">
                                        Table ${order.tables?.table_number || 'N/A'} â€¢ 
                                        <span title="${exactTime}">${relativeTime}</span>
                                    </p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-[#181410] dark:text-white">$${order.total_amount?.toFixed(2) || '0.00'}</p>
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                    order.status === 'completed' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' :
                                    order.status === 'preparing' ? 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200' :
                                    'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200'
                                }">${order.status}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            displayPopularItems(menuItems, orders) {
                const container = document.getElementById('popularItems');
                
                if (!menuItems || menuItems.length === 0) {
                    container.innerHTML = `
                        <div class="text-center text-[#8d755e] dark:text-[#a1907c] py-8 col-span-full">
                            <span class="material-symbols-outlined text-4xl mb-2">restaurant</span>
                            <p>No menu items yet</p>
                            <a href="menu-management.html" class="text-primary hover:underline mt-2 inline-block">Add your first menu item</a>
                        </div>
                    `;
                    return;
                }

                // Calculate item popularity from order items
                const itemCounts = {};
                orders.forEach(order => {
                    order.order_items?.forEach(item => {
                        const itemId = item.menu_item_id;
                        itemCounts[itemId] = (itemCounts[itemId] || 0) + item.quantity;
                    });
                });

                // Get top 5 popular items
                const popularItems = menuItems
                    .map(item => ({
                        ...item,
                        orderCount: itemCounts[item.id] || 0
                    }))
                    .sort((a, b) => b.orderCount - a.orderCount)
                    .slice(0, 5);

                if (popularItems.length === 0 || popularItems.every(item => item.orderCount === 0)) {
                    container.innerHTML = `
                        <div class="text-center text-[#8d755e] dark:text-[#a1907c] py-8 col-span-full">
                            <span class="material-symbols-outlined text-4xl mb-2">restaurant</span>
                            <p>No popular items yet</p>
                            <p class="text-sm">Orders will appear here once you start receiving them</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = popularItems.map(item => `
                    <div class="bg-white dark:bg-[#2a2116] rounded-lg shadow-sm border border-[#f5f2f0] dark:border-[#2f271f] p-4">
                        <div class="h-32 bg-gray-200 rounded-lg mb-3 bg-cover bg-center" 
                             style="background-image: url('${item.image_url || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80'}')">
                        </div>
                        <h3 class="font-semibold text-[#181410] dark:text-white mb-1">${item.name}</h3>
                        <p class="text-primary font-bold mb-2">$${item.price}</p>
                        <div class="flex justify-between items-center text-sm text-[#8d755e] dark:text-[#a1907c]">
                            <span>${item.orderCount} orders</span>
                            <span class="flex items-center gap-1">
                                <span class="material-symbols-outlined text-base ${item.is_available ? 'text-green-500' : 'text-red-500'}">
                                    ${item.is_available ? 'check_circle' : 'cancel'}
                                </span>
                                ${item.is_available ? 'Available' : 'Unavailable'}
                            </span>
                        </div>
                    </div>
                `).join('');
            }

            showNotification(message, type = 'info') {
                // Remove existing notification
                const existingNotification = document.querySelector('.notification-toast');
                if (existingNotification) {
                    existingNotification.remove();
                }

                // Create notification
                const notification = document.createElement('div');
                notification.className = `notification-toast fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg ${
                    type === 'success' ? 'bg-green-500 text-white' : 
                    type === 'error' ? 'bg-red-500 text-white' : 
                    'bg-blue-500 text-white'
                }`;
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                // Auto remove after 5 seconds
                setTimeout(() => {
                    notification.remove();
                }, 5000);
            }

            async logout() {
                try {
                    await AuthService.logout();
                    window.location.href = 'login.html';
                } catch (error) {
                    console.error('Logout error:', error);
                }
            }
        }

        // Initialize dashboard
        new Dashboard();
    </script>
</body>
</html>